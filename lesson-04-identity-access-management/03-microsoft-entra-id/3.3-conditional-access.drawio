<mxfile host="app.diagrams.net" modified="2025-01-01T00:00:00.000Z" agent="Claude" version="21.0.0">
  <diagram name="Conditional Access" id="conditional-access">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="🔑 Conditional Access - Context-Aware Security Policies" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;fontColor=#1a1a2e;" parent="1" vertex="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry" />
        </mxCell>

        <!-- Overview -->
        <mxCell id="overview-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1565c0;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="70" width="1500" height="80" as="geometry" />
        </mxCell>
        <mxCell id="overview-title" value="What is Conditional Access?" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#1565c0;" parent="1" vertex="1">
          <mxGeometry x="70" y="80" width="280" height="25" as="geometry" />
        </mxCell>
        <mxCell id="overview-desc" value="Conditional Access policies are IF-THEN statements: IF a user wants to access a resource, THEN they must complete an action. It brings signals together to make decisions and enforce organizational policies." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=12;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="70" y="105" width="1000" height="25" as="geometry" />
        </mxCell>
        <mxCell id="overview-formula" value="Signals + Decision = Enforcement" style="text;html=1;strokeColor=none;fillColor=#bbdefb;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#0d47a1;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1270" y="90" width="250" height="35" as="geometry" />
        </mxCell>

        <!-- Main Policy Structure -->
        <mxCell id="policy-container" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="170" width="1500" height="350" as="geometry" />
        </mxCell>

        <mxCell id="policy-title" value="Conditional Access Policy Structure" style="text;html=1;strokeColor=none;fillColor=#e65100;align=center;verticalAlign=middle;fontSize=18;fontStyle=1;fontColor=#ffffff;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="600" y="185" width="400" height="30" as="geometry" />
        </mxCell>

        <!-- WHEN (Assignments) -->
        <mxCell id="when-container" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ff8f00;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="230" width="700" height="270" as="geometry" />
        </mxCell>
        <mxCell id="when-title" value="WHEN (Assignments) - Conditions that trigger the policy" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#e65100;" parent="1" vertex="1">
          <mxGeometry x="180" y="235" width="500" height="25" as="geometry" />
        </mxCell>

        <!-- Users and Groups -->
        <mxCell id="users-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff8e1;strokeColor=#ffc107;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="100" y="270" width="200" height="110" as="geometry" />
        </mxCell>
        <mxCell id="users-icon" value="👤" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=20;" parent="1" vertex="1">
          <mxGeometry x="175" y="275" width="50" height="25" as="geometry" />
        </mxCell>
        <mxCell id="users-title" value="Users &amp; Groups" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#e65100;" parent="1" vertex="1">
          <mxGeometry x="130" y="300" width="140" height="18" as="geometry" />
        </mxCell>
        <mxCell id="users-list" value="• All users&#xa;• Specific groups&#xa;• Directory roles&#xa;• Guest users&#xa;• Exclude accounts" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="115" y="320" width="170" height="55" as="geometry" />
        </mxCell>

        <!-- Cloud Apps -->
        <mxCell id="apps-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff8e1;strokeColor=#ffc107;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="320" y="270" width="200" height="110" as="geometry" />
        </mxCell>
        <mxCell id="apps-icon" value="☁️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=20;" parent="1" vertex="1">
          <mxGeometry x="395" y="275" width="50" height="25" as="geometry" />
        </mxCell>
        <mxCell id="apps-title" value="Cloud Apps/Actions" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#e65100;" parent="1" vertex="1">
          <mxGeometry x="350" y="300" width="140" height="18" as="geometry" />
        </mxCell>
        <mxCell id="apps-list" value="• All cloud apps&#xa;• Office 365&#xa;• Microsoft Azure Mgmt&#xa;• Custom apps&#xa;• User actions (register)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="335" y="320" width="170" height="55" as="geometry" />
        </mxCell>

        <!-- Conditions -->
        <mxCell id="conditions-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff8e1;strokeColor=#ffc107;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="540" y="270" width="220" height="220" as="geometry" />
        </mxCell>
        <mxCell id="conditions-icon" value="⚡" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=20;" parent="1" vertex="1">
          <mxGeometry x="625" y="275" width="50" height="25" as="geometry" />
        </mxCell>
        <mxCell id="conditions-title" value="Conditions (Signals)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#e65100;" parent="1" vertex="1">
          <mxGeometry x="580" y="300" width="140" height="18" as="geometry" />
        </mxCell>
        <mxCell id="conditions-list" value="📍 Locations&#xa;   • Trusted IPs/Named locations&#xa;   • Countries/regions&#xa;💻 Device platforms&#xa;   • Windows, iOS, Android, macOS&#xa;📱 Client apps&#xa;   • Browser, mobile, desktop&#xa;🔒 Device state&#xa;   • Compliant, Hybrid joined&#xa;⚠️ Sign-in risk (P2)&#xa;   • Low, Medium, High&#xa;👤 User risk (P2)&#xa;   • Compromised accounts" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="555" y="320" width="190" height="165" as="geometry" />
        </mxCell>

        <!-- THEN Arrow -->
        <mxCell id="then-arrow" value="" style="endArrow=classic;html=1;strokeColor=#e65100;strokeWidth=4;shadow=1;curved=1;flowAnimation=1;jumpStyle=arc" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="790" y="375" as="sourcePoint" />
            <mxPoint x="840" y="375" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="then-label" value="THEN" style="text;html=1;strokeColor=none;fillColor=#e65100;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#ffffff;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="790" y="345" width="50" height="22" as="geometry" />
        </mxCell>

        <!-- THEN (Access Controls) -->
        <mxCell id="then-container" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ff8f00;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="850" y="230" width="680" height="270" as="geometry" />
        </mxCell>
        <mxCell id="then-title" value="THEN (Access Controls) - What happens" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#e65100;" parent="1" vertex="1">
          <mxGeometry x="1020" y="235" width="340" height="25" as="geometry" />
        </mxCell>

        <!-- Block -->
        <mxCell id="block-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffebee;strokeColor=#ef5350;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="880" y="270" width="180" height="80" as="geometry" />
        </mxCell>
        <mxCell id="block-title" value="❌ Block Access" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#c62828;" parent="1" vertex="1">
          <mxGeometry x="915" y="280" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="block-desc" value="Deny access completely&#xa;Strongest control" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="895" y="305" width="150" height="40" as="geometry" />
        </mxCell>

        <!-- Grant -->
        <mxCell id="grant-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#43a047;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1080" y="270" width="220" height="220" as="geometry" />
        </mxCell>
        <mxCell id="grant-title" value="✅ Grant Access" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="1135" y="280" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="grant-desc" value="With requirements:" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=10;fontStyle=2;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="1130" y="300" width="120" height="15" as="geometry" />
        </mxCell>
        <mxCell id="grant-list" value="☐ Require MFA&#xa;☐ Require compliant device&#xa;☐ Require Hybrid Azure AD join&#xa;☐ Require approved client app&#xa;☐ Require app protection policy&#xa;☐ Require password change&#xa;☐ Require all selected controls&#xa;☐ Require one of selected" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="1100" y="320" width="185" height="120" as="geometry" />
        </mxCell>
        <mxCell id="grant-note" value="+ Terms of Use" style="text;html=1;strokeColor=none;fillColor=#c8e6c9;align=center;verticalAlign=middle;fontSize=10;fontColor=#2e7d32;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1125" y="450" width="130" height="25" as="geometry" />
        </mxCell>

        <!-- Session -->
        <mxCell id="session-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1976d2;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1320" y="270" width="190" height="220" as="geometry" />
        </mxCell>
        <mxCell id="session-title" value="🔐 Session Controls" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#1565c0;" parent="1" vertex="1">
          <mxGeometry x="1355" y="280" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="session-list" value="• App enforced restrictions&#xa;  (SharePoint/Exchange limits)&#xa;&#xa;• Conditional Access App Control&#xa;  (Defender for Cloud Apps)&#xa;&#xa;• Sign-in frequency&#xa;  (Re-auth every N hours)&#xa;&#xa;• Persistent browser session&#xa;  (Remember me)&#xa;&#xa;• Disable resilience defaults" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="1335" y="305" width="165" height="175" as="geometry" />
        </mxCell>

        <!-- Common Policies Section -->
        <mxCell id="policies-section" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#2e7d32;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="540" width="1500" height="200" as="geometry" />
        </mxCell>

        <mxCell id="policies-section-title" value="Common Conditional Access Policies" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=18;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="580" y="550" width="400" height="25" as="geometry" />
        </mxCell>

        <!-- Policy 1 -->
        <mxCell id="p1-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#43a047;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="585" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="p1-title" value="🛡️ MFA for Admins" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="140" y="590" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p1-when" value="WHEN: User is in admin role" style="text;html=1;strokeColor=none;fillColor=#c8e6c9;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="95" y="615" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p1-then" value="THEN: Require MFA" style="text;html=1;strokeColor=none;fillColor=#a5d6a7;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="95" y="640" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p1-note" value="Critical: Always require MFA for&#xa;Global Admin, Security Admin, etc." style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontStyle=2;fontColor=#616161;" parent="1" vertex="1">
          <mxGeometry x="95" y="665" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p1-priority" value="Priority: 1" style="text;html=1;strokeColor=none;fillColor=#ffeb3b;align=center;verticalAlign=middle;fontSize=9;fontStyle=1;fontColor=#424242;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="290" y="695" width="55" height="18" as="geometry" />
        </mxCell>

        <!-- Policy 2 -->
        <mxCell id="p2-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#43a047;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="380" y="585" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="p2-title" value="🚫 Block Legacy Auth" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="440" y="590" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p2-when" value="WHEN: Client app is &quot;Other clients&quot;" style="text;html=1;strokeColor=none;fillColor=#c8e6c9;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="395" y="615" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p2-then" value="THEN: Block access" style="text;html=1;strokeColor=none;fillColor=#ffcdd2;align=left;verticalAlign=middle;fontSize=10;fontColor=#b71c1c;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="395" y="640" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p2-note" value="Blocks IMAP, SMTP, POP3 etc.&#xa;that don't support MFA" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontStyle=2;fontColor=#616161;" parent="1" vertex="1">
          <mxGeometry x="395" y="665" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p2-priority" value="Priority: 2" style="text;html=1;strokeColor=none;fillColor=#ffeb3b;align=center;verticalAlign=middle;fontSize=9;fontStyle=1;fontColor=#424242;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="590" y="695" width="55" height="18" as="geometry" />
        </mxCell>

        <!-- Policy 3 -->
        <mxCell id="p3-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#43a047;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="585" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="p3-title" value="📍 MFA Outside Office" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="740" y="590" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p3-when" value="WHEN: Location is NOT trusted" style="text;html=1;strokeColor=none;fillColor=#c8e6c9;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="695" y="615" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p3-then" value="THEN: Require MFA" style="text;html=1;strokeColor=none;fillColor=#a5d6a7;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="695" y="640" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p3-note" value="Define office IPs as trusted locations&#xa;Skip MFA when in office" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontStyle=2;fontColor=#616161;" parent="1" vertex="1">
          <mxGeometry x="695" y="665" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p3-priority" value="Priority: 3" style="text;html=1;strokeColor=none;fillColor=#ffeb3b;align=center;verticalAlign=middle;fontSize=9;fontStyle=1;fontColor=#424242;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="890" y="695" width="55" height="18" as="geometry" />
        </mxCell>

        <!-- Policy 4 -->
        <mxCell id="p4-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#43a047;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="980" y="585" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="p4-title" value="💻 Compliant Devices" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="1040" y="590" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p4-when" value="WHEN: Accessing Office 365" style="text;html=1;strokeColor=none;fillColor=#c8e6c9;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="995" y="615" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p4-then" value="THEN: Require compliant device" style="text;html=1;strokeColor=none;fillColor=#a5d6a7;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="995" y="640" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p4-note" value="Intune marks devices as compliant&#xa;based on compliance policies" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontStyle=2;fontColor=#616161;" parent="1" vertex="1">
          <mxGeometry x="995" y="665" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p4-priority" value="Priority: 4" style="text;html=1;strokeColor=none;fillColor=#ffeb3b;align=center;verticalAlign=middle;fontSize=9;fontStyle=1;fontColor=#424242;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1190" y="695" width="55" height="18" as="geometry" />
        </mxCell>

        <!-- Policy 5 -->
        <mxCell id="p5-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#43a047;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1280" y="585" width="250" height="140" as="geometry" />
        </mxCell>
        <mxCell id="p5-title" value="⚠️ Block High-Risk Sign-ins" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="1310" y="590" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p5-when" value="WHEN: Sign-in risk is High" style="text;html=1;strokeColor=none;fillColor=#c8e6c9;align=left;verticalAlign=middle;fontSize=10;fontColor=#1b5e20;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1295" y="615" width="220" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p5-then" value="THEN: Block access" style="text;html=1;strokeColor=none;fillColor=#ffcdd2;align=left;verticalAlign=middle;fontSize=10;fontColor=#b71c1c;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1295" y="640" width="220" height="20" as="geometry" />
        </mxCell>
        <mxCell id="p5-note" value="Requires P2 license&#xa;Identity Protection signals" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontStyle=2;fontColor=#616161;" parent="1" vertex="1">
          <mxGeometry x="1295" y="665" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p5-badge" value="P2" style="text;html=1;strokeColor=none;fillColor=#7b1fa2;align=center;verticalAlign=middle;fontSize=9;fontStyle=1;fontColor=#ffffff;rounded=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1485" y="595" width="30" height="18" as="geometry" />
        </mxCell>

        <!-- Best Practices Section -->
        <mxCell id="bp-container" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#616161;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="760" width="1500" height="200" as="geometry" />
        </mxCell>

        <mxCell id="bp-title" value="Conditional Access Best Practices" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=18;fontStyle=1;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="580" y="770" width="400" height="25" as="geometry" />
        </mxCell>

        <!-- Best Practices -->
        <mxCell id="bp1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#43a047;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="805" width="240" height="140" as="geometry" />
        </mxCell>
        <mxCell id="bp1-title" value="✓ Emergency Access" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#2e7d32;" parent="1" vertex="1">
          <mxGeometry x="125" y="812" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="bp1-content" value="• Create break-glass accounts&#xa;• Exclude from ALL policies&#xa;• Use complex passwords&#xa;• Monitor usage with alerts&#xa;• Store credentials securely" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="95" y="835" width="210" height="100" as="geometry" />
        </mxCell>

        <mxCell id="bp2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#ff8f00;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="340" y="805" width="240" height="140" as="geometry" />
        </mxCell>
        <mxCell id="bp2-title" value="✓ Report-Only Mode" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#e65100;" parent="1" vertex="1">
          <mxGeometry x="385" y="812" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="bp2-content" value="• Test policies before enabling&#xa;• Review sign-in logs&#xa;• Check &quot;What If&quot; tool&#xa;• Monitor for 1-2 weeks&#xa;• Then switch to On" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="355" y="835" width="210" height="100" as="geometry" />
        </mxCell>

        <mxCell id="bp3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1976d2;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="600" y="805" width="240" height="140" as="geometry" />
        </mxCell>
        <mxCell id="bp3-title" value="✓ Named Locations" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#1565c0;" parent="1" vertex="1">
          <mxGeometry x="645" y="812" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="bp3-content" value="• Define office IP ranges&#xa;• Mark VPN gateways as trusted&#xa;• Block countries you don't operate&#xa;• Use GPS-based for mobile&#xa;• Regular updates required" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="615" y="835" width="210" height="100" as="geometry" />
        </mxCell>

        <mxCell id="bp4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#c2185b;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="860" y="805" width="240" height="140" as="geometry" />
        </mxCell>
        <mxCell id="bp4-title" value="✓ Policy Ordering" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#c2185b;" parent="1" vertex="1">
          <mxGeometry x="905" y="812" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="bp4-content" value="• All policies are evaluated&#xa;• Block wins over Grant&#xa;• Most restrictive wins&#xa;• No priority ordering&#xa;• Use exclusions carefully" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="875" y="835" width="210" height="100" as="geometry" />
        </mxCell>

        <mxCell id="bp5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#7b1fa2;strokeWidth=1;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1120" y="805" width="240" height="140" as="geometry" />
        </mxCell>
        <mxCell id="bp5-title" value="✓ Monitoring" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#7b1fa2;" parent="1" vertex="1">
          <mxGeometry x="1165" y="812" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="bp5-content" value="• Review sign-in logs regularly&#xa;• Set up failure alerts&#xa;• Monitor blocked sign-ins&#xa;• Check policy impact reports&#xa;• Workbooks for insights" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=10;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="1135" y="835" width="210" height="100" as="geometry" />
        </mxCell>

        <!-- Warning -->
        <mxCell id="warning-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffebee;strokeColor=#c62828;strokeWidth=2;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="1380" y="805" width="150" height="140" as="geometry" />
        </mxCell>
        <mxCell id="warning-icon" value="⚠️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=28;" parent="1" vertex="1">
          <mxGeometry x="1430" y="810" width="50" height="35" as="geometry" />
        </mxCell>
        <mxCell id="warning-title" value="Common Mistakes" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#c62828;" parent="1" vertex="1">
          <mxGeometry x="1395" y="845" width="120" height="18" as="geometry" />
        </mxCell>
        <mxCell id="warning-list" value="• No break-glass account&#xa;• No report-only testing&#xa;• Locking out admins&#xa;• Too many exclusions&#xa;• Not monitoring" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontColor=#424242;" parent="1" vertex="1">
          <mxGeometry x="1395" y="865" width="125" height="75" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
