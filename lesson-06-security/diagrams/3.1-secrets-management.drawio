<mxfile host="app.diagrams.net" modified="2026-02-02T00:00:00.000Z" agent="Claude" version="21.0.0" type="device">
  <diagram id="secrets-management" name="Secrets Management">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Secrets Management Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="400" y="20" width="600" height="40" as="geometry" />
        </mxCell>

        <!-- Application Layer -->
        <mxCell id="app-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;opacity=30;" parent="1" vertex="1">
          <mxGeometry x="80" y="80" width="300" height="200" as="geometry" />
        </mxCell>
        <mxCell id="app-title" value="Application Layer" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="130" y="90" width="200" height="25" as="geometry" />
        </mxCell>

        <mxCell id="app1" value="Web App" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="100" y="130" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="app2" value="API Service" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="190" y="130" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="app3" value="Worker" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="280" y="130" width="80" height="50" as="geometry" />
        </mxCell>

        <mxCell id="sdk" value="Secrets SDK / Client Library" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="100" y="210" width="260" height="40" as="geometry" />
        </mxCell>

        <!-- Secrets Manager -->
        <mxCell id="vault-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="450" y="80" width="300" height="200" as="geometry" />
        </mxCell>
        <mxCell id="vault-title" value="Secrets Management Service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="90" width="240" height="25" as="geometry" />
        </mxCell>

        <mxCell id="auth" value="Authentication&#xa;&amp; Authorization" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="470" y="125" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="encrypt" value="Encryption&#xa;Engine" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="580" y="125" width="80" height="45" as="geometry" />
        </mxCell>
        <mxCell id="audit" value="Audit&#xa;Logging" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="670" y="125" width="60" height="45" as="geometry" />
        </mxCell>

        <mxCell id="secrets-store" value="Encrypted Secrets Store" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=10;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="540" y="190" width="120" height="70" as="geometry" />
        </mxCell>

        <!-- Arrow from App to Vault -->
        <mxCell id="arrow1" value="1. Request Secret&#xa;(with auth token)" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="360" y="180" as="sourcePoint" />
            <mxPoint x="450" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow2" value="2. Return Secret&#xa;(encrypted in transit)" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#82b366;dashed=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="450" y="210" as="sourcePoint" />
            <mxPoint x="360" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Cloud Providers -->
        <mxCell id="providers-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="820" y="80" width="500" height="200" as="geometry" />
        </mxCell>
        <mxCell id="providers-title" value="Secrets Management Solutions" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="950" y="90" width="240" height="25" as="geometry" />
        </mxCell>

        <mxCell id="azure-kv" value="Azure Key Vault" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="840" y="130" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="azure-kv-feat" value="• HSM-backed&#xa;• Azure AD integration&#xa;• Managed identities" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="840" y="175" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="hashi-vault" value="HashiCorp Vault" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="960" y="130" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hashi-feat" value="• Multi-cloud&#xa;• Dynamic secrets&#xa;• PKI management" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="960" y="175" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="aws-sm" value="AWS Secrets Manager" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1080" y="130" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="aws-feat" value="• Auto rotation&#xa;• RDS integration&#xa;• Lambda support" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1080" y="175" width="100" height="50" as="geometry" />
        </mxCell>

        <mxCell id="gcp-sm" value="GCP Secret Manager" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1200" y="130" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gcp-feat" value="• IAM integration&#xa;• Auto replication&#xa;• Version control" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1200" y="175" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- Best Practices Section -->
        <mxCell id="best-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="80" y="320" width="600" height="280" as="geometry" />
        </mxCell>
        <mxCell id="best-title" value="✓ DO - Best Practices" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="100" y="330" width="200" height="30" as="geometry" />
        </mxCell>

        <mxCell id="do1" value="Use dedicated secrets management tools" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="100" y="370" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="do2" value="Rotate secrets regularly (automated)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="100" y="410" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="do3" value="Use short-lived credentials" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="100" y="450" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="do4" value="Audit secret access" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="100" y="490" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="do5" value="Use managed identities where possible" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="100" y="530" width="260" height="30" as="geometry" />
        </mxCell>

        <mxCell id="do-note1" value="Azure: Managed Identity&#xa;AWS: IAM Roles&#xa;GCP: Service Accounts" style="text;html=1;strokeColor=#82b366;fillColor=#f0fff0;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="380" y="370" width="140" height="55" as="geometry" />
        </mxCell>

        <mxCell id="do-note2" value="Rotation frequency:&#xa;• DB passwords: 30-90 days&#xa;• API keys: 90 days&#xa;• Certificates: yearly" style="text;html=1;strokeColor=#82b366;fillColor=#f0fff0;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="380" y="440" width="140" height="70" as="geometry" />
        </mxCell>

        <mxCell id="do-note3" value="Short-lived = minutes to hours&#xa;Not days or months" style="text;html=1;strokeColor=#82b366;fillColor=#f0fff0;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="380" y="520" width="140" height="40" as="geometry" />
        </mxCell>

        <!-- Don't Section -->
        <mxCell id="dont-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="720" y="320" width="600" height="280" as="geometry" />
        </mxCell>
        <mxCell id="dont-title" value="✗ DON'T - Anti-Patterns" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="740" y="330" width="200" height="30" as="geometry" />
        </mxCell>

        <mxCell id="dont1" value="Store secrets in code" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="740" y="370" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dont1-ex" value="const API_KEY = &quot;sk-123...&quot;; // BAD!" style="text;html=1;strokeColor=#b85450;fillColor=#fff5f5;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=9;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="960" y="370" width="220" height="25" as="geometry" />
        </mxCell>

        <mxCell id="dont2" value="Store secrets in env vars (prod)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="740" y="410" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dont2-ex" value="Can be leaked via logs, dumps, child processes" style="text;html=1;strokeColor=#b85450;fillColor=#fff5f5;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="960" y="410" width="230" height="25" as="geometry" />
        </mxCell>

        <mxCell id="dont3" value="Log secrets" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="740" y="450" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dont3-ex" value="Use secret masking in log frameworks" style="text;html=1;strokeColor=#b85450;fillColor=#fff5f5;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="960" y="450" width="200" height="25" as="geometry" />
        </mxCell>

        <mxCell id="dont4" value="Share secrets via email/chat" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="740" y="490" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dont4-ex" value="Use vault links or encrypted channels only" style="text;html=1;strokeColor=#b85450;fillColor=#fff5f5;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="960" y="490" width="220" height="25" as="geometry" />
        </mxCell>

        <mxCell id="dont5" value="Use same secret across environments" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;fontSize=11;align=left;spacingLeft=10;" parent="1" vertex="1">
          <mxGeometry x="740" y="530" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dont5-ex" value="Separate secrets for dev/staging/prod" style="text;html=1;strokeColor=#b85450;fillColor=#fff5f5;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="960" y="530" width="200" height="25" as="geometry" />
        </mxCell>

        <!-- Secret Lifecycle -->
        <mxCell id="lifecycle-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="620" width="1240" height="100" as="geometry" />
        </mxCell>
        <mxCell id="lifecycle-title" value="Secret Lifecycle" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="100" y="630" width="150" height="25" as="geometry" />
        </mxCell>

        <mxCell id="lc1" value="Create" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="120" y="670" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="lc2" value="Store" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="280" y="670" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="lc3" value="Distribute" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="670" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="lc4" value="Use" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="600" y="670" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="lc5" value="Rotate" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="760" y="670" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="lc6" value="Revoke" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="920" y="670" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="lc7" value="Audit" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1080" y="670" width="80" height="35" as="geometry" />
        </mxCell>

        <!-- Arrows -->
        <mxCell id="lc-arr1" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="200" y="687" as="sourcePoint" />
            <mxPoint x="280" y="687" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lc-arr2" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="360" y="687" as="sourcePoint" />
            <mxPoint x="440" y="687" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lc-arr3" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="520" y="687" as="sourcePoint" />
            <mxPoint x="600" y="687" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lc-arr4" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="680" y="687" as="sourcePoint" />
            <mxPoint x="760" y="687" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lc-arr5" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="840" y="687" as="sourcePoint" />
            <mxPoint x="920" y="687" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lc-arr6" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1000" y="687" as="sourcePoint" />
            <mxPoint x="1080" y="687" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Continuous Loop Arrow -->
        <mxCell id="lc-loop" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#82b366;curved=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1160" y="687" as="sourcePoint" />
            <mxPoint x="120" y="687" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1200" y="640" />
              <mxPoint x="700" y="640" />
              <mxPoint x="80" y="640" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="loop-label" value="Continuous cycle" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=2;fontColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="600" y="620" width="100" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
